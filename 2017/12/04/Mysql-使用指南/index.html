<!DOCTYPE html>
<html lang="en">
  <head>
    
<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">



  <meta name="description" content="Mysql 使用指南"/>




  <meta name="keywords" content="Mysql, Corn1ng's Blog" />










  <link rel="alternate" href="/default" title="Corn1ng's Blog">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=2.6.0" />



<link rel="canonical" href="https://corn1ng.github.io/2017/12/04/Mysql-使用指南/"/>


<link rel="stylesheet" type="text/css" href="/css/style.css?v=2.6.0" />



  <link rel="stylesheet" type="text/css" href="/lib/fancybox/jquery.fancybox.css" />




  



  <script id="baidu_push">
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>









    <title> Mysql 使用指南 - Corn1ng's Blog </title>\
    <style type="text/css">
    .content-wrapper:{top:200px;}
    .footer:{top:200px;}
    </style>
  </head>

  <body><div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/." class="logo">Corn1ng's Blog</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>

<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    
      <a href="/">
        <li class="mobile-menu-item">
          
          
            Home
          
        </li>
      </a>
    
      <a href="/archives/">
        <li class="mobile-menu-item">
          
          
            Archives
          
        </li>
      </a>
    
      <a href="/tags">
        <li class="mobile-menu-item">
          
          
            Tags
          
        </li>
      </a>
    
      <a href="/categories">
        <li class="mobile-menu-item">
          
          
            Categories
          
        </li>
      </a>
    
      <a href="/about">
        <li class="mobile-menu-item">
          
          
            About
          
        </li>
      </a>
    
  </ul>
</nav>

    <div class="container" id="mobile-panel">
      <header id="header" class="header"><div class="logo-wrapper">
  <a href="/." class="logo">Corn1ng's Blog</a>
</div>

<nav class="site-navbar">
  
    <ul id="menu" class="menu">
      
        <li class="menu-item">
          <a class="menu-item-link" href="/">
            
            
              Home
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/archives/">
            
            
              Archives
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/tags">
            
            
              Tags
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/categories">
            
            
              Categories
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/about">
            
            
              About
            
          </a>
        </li>
      
    </ul>
  
</nav>

      </header>
      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content">
            
  
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          Mysql 使用指南
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          2017-12-04
        </span>
        
          <div class="post-category">
            
              <a href="/categories/数据库/">数据库</a>
            
          </div>
        
        
      </div>
    </header>

    
    
  <div class="post-toc" id="post-toc">
    <h2 class="post-toc-title">Contents</h2>
    <div class="post-toc-content">
      <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#帮助的使用"><span class="toc-text">帮助的使用</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#按照层次看帮助"><span class="toc-text">按照层次看帮助</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#快速查阅帮助"><span class="toc-text">快速查阅帮助</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#字符集"><span class="toc-text">字符集</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#概述"><span class="toc-text">概述</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#MySQL支持的字符集"><span class="toc-text">MySQL支持的字符集</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#字符集的设置"><span class="toc-text">字符集的设置</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#索引的设计与使用"><span class="toc-text">索引的设计与使用</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#概述-1"><span class="toc-text">概述</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#设计引擎的原则"><span class="toc-text">设计引擎的原则</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#btree索引和hash索引"><span class="toc-text">btree索引和hash索引</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#锁机制和事务控制"><span class="toc-text">锁机制和事务控制</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#事务控制"><span class="toc-text">事务控制</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#常用SQL技巧"><span class="toc-text">常用SQL技巧</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#检索包含最大-最小值的行-使用max-min-函数-找不到返回NULL"><span class="toc-text">检索包含最大/最小值的行(使用max min 函数 找不到返回NULL)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#提取随机行"><span class="toc-text">提取随机行</span></a></li></ol></li></ol></li></ol>
    </div>
  </div>


    <div class="post-content">
      
        <h3 id="帮助的使用"><a href="#帮助的使用" class="headerlink" title="帮助的使用"></a>帮助的使用</h3><h5 id="按照层次看帮助"><a href="#按照层次看帮助" class="headerlink" title="按照层次看帮助"></a>按照层次看帮助</h5><p>如果不知道帮助提供什么,可以一层一层往下看:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MySQL&gt; ? content</span><br><span class="line"># 在列出的分类中继续使用 ? (内容) 查看对应的帮助</span><br></pre></td></tr></table></figure>
<h5 id="快速查阅帮助"><a href="#快速查阅帮助" class="headerlink" title="快速查阅帮助"></a>快速查阅帮助</h5><p>需要快速查阅某项语法时,用关键字进行快速查询. 也是使用 ? </p>
<a id="more"></a>
<p>###　表类型（存储引擎）的选择</p>
<p>mysql的存储引擎包括:MyISAM、 InnoDB、BDB、MEMORY、MERGE、EXAMPLE、NDB Cluster、<br>ARCHIVE、CSV、BLACKHOLE、FEDERATED等,其中InnoDB和BDB提供事务安全表,其他存储引<br>擎都是非事务安全表. </p>
<p><strong>Myisam</strong> mysql默认存储引擎,当create创建新表时,未指定新表存储引擎时,默认使用Myisam.</p>
<p>每个MyISAM在磁盘上存储成三个文件。文件名都和表名相同,扩展名分别是 .frm(存储表定义)、.MYD (MYData,存储数据)、.MYI (MYIndex,存储索引)。数据文件和索引文件可以放置在不同的目录,平均分布io,获得更快的速度。<em>是在web,数据仓储和其他应用环境下最常用的存储引擎之一</em></p>
<p><strong>InnoDB</strong> 存储引擎提供了具有提交、回滚和崩溃恢复能力的事务安全。但是对比 Myisam的存储引擎,InnoDB 写的处理效率差一些并且会占用更多的磁盘空间以保留数据和索引。<em>用于事务处理应用程序,具有众多特性,包括ACID 事务支持</em></p>
<h3 id="字符集"><a href="#字符集" class="headerlink" title="字符集"></a>字符集</h3><h5 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h5><p>字符集是一套符号和编码的规则,不论在Oracle 还是MySQL,都存在字符集的选择问题,后期字符集的更换是比较高的操作,页存在风险,所以在应用开始阶段,就按照需求选择合适的字符集,避免后期不必要的调整.</p>
<h5 id="MySQL支持的字符集"><a href="#MySQL支持的字符集" class="headerlink" title="MySQL支持的字符集"></a>MySQL支持的字符集</h5><p>可以用<code>show character set</code>命令查看所有MySQL支持的字符集,</p>
<p>MySQL的字符集包括字符集(CHARACTER)和校对规则(COLLATION)两个概念,字符集是用来定义MySQL存储字符串的方式,校对规则是定义了比较字符串的方式,字符集和校对规则是一对多的关系.每个字符集至少一个校对规则,可以用<code>show COLLATION LIKE &#39;utf8%&#39;;</code>命令查看相关字符集的校对规则.</p>
<h5 id="字符集的设置"><a href="#字符集的设置" class="headerlink" title="字符集的设置"></a>字符集的设置</h5><p>mysql 的字符集和校对规则有 4 个级别的默认设置:服务器级、数据库级、表级和字段级。分别在不同的地方设置,作用也不相同。</p>
<h3 id="索引的设计与使用"><a href="#索引的设计与使用" class="headerlink" title="索引的设计与使用"></a>索引的设计与使用</h3><h5 id="概述-1"><a href="#概述-1" class="headerlink" title="概述"></a>概述</h5><p>索引可以理解为就是数据库的目录,目的是为了让数据库更快的找回返回的数据.</p>
<p>对相关列使用索引是提高SELECT操作性能的最佳途径.存储引擎支持每个表至少16个索引,总索引长度至少256字节,大多数存储引擎有更高的限制.</p>
<h5 id="设计引擎的原则"><a href="#设计引擎的原则" class="headerlink" title="设计引擎的原则"></a>设计引擎的原则</h5><p>1: 最适合索引的列是出现在where子句中的列,或连接子句中指定的列,而不是出现在select关键字后的选择列表中的列.</p>
<p>2: 使用唯一索引,考虑某列中值的分布,对于唯一值的列,效果最好,多个重复值的列,效果最差.(例如,年龄的就很容易区分,但是性别的就没什么用)</p>
<p>3: 使用短索引,如果有一个char(200)列, 如果在前10个或20个字符内,多数值是唯一的,就不要对整个列进行索引.对前10个字符索引能够节省大量索引空间,也可能查询更快</p>
<p>4: 最左前缀：顾名思义，就是最左优先，比如我们创建了lname_fname_age多列索引,相当于创建了(lname)单列索引，(lname,fname)组合索引以及(lname,fname,age)组合索引。这样一个多列索引可以起几个索引的作用,因为可以利用索引中最左边的列集来匹配行.</p>
<p>5: 不要过度索引 索引并不是越多越好,每个额外的索引都要占用额外的磁盘空间,并降低写操作的性能.</p>
<p>6: 考虑在列上进行的比较类型,索引可用于<code>&lt;</code> <code>&lt;=</code> <code>=</code> <code>&gt;</code> <code>&gt;=</code> <code>between</code> 运算,在模式具有一个直接量前缀时,索引也用于 LIKE 运算。如果只将某个列用于其他类型的运算时(如 STRCMP( )),对其进行索引没有价值。 </p>
<h5 id="btree索引和hash索引"><a href="#btree索引和hash索引" class="headerlink" title="btree索引和hash索引"></a>btree索引和hash索引</h5><p>hsah索引把数据的索引以hash形式组织起来，因此当查找某一条记录的时候,速度非常快。当时因为是hash结构，每个键只对应一个值，而且是散列的方式分布。所以他并不支持范围查找和排序等功能。</p>
<p>B+tree是mysql使用最频繁的一个索引数据结构，是Inodb和Myisam存储引擎模式的索引类型。相对Hash索引，B+树在查找单条记录的速度比不上Hash索引，但是因为更适合排序等操作，所以他更受用户的欢迎。毕竟不可能只对数据库进行单条记录的操作.</p>
<h3 id="锁机制和事务控制"><a href="#锁机制和事务控制" class="headerlink" title="锁机制和事务控制"></a>锁机制和事务控制</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 加锁</span><br><span class="line">LOCK TABLES</span><br><span class="line">#　解锁</span><br><span class="line">UNLOCK TABLES</span><br></pre></td></tr></table></figure>
<p>InnoDB提供行级锁,支持共享锁和排他锁两种锁定模式,以及四种不同的隔离级别.</p>
<h5 id="事务控制"><a href="#事务控制" class="headerlink" title="事务控制"></a>事务控制</h5><p> 在mysql命令行的默认下，事务都是自动提交的，sql语句提交后马上会执行commit操作。</p>
<p>事务控制语句:</p>
<ul>
<li>start transaction 或 begin ; 显式的开启一个事务</li>
<li>commit ,提交事务,</li>
<li>rollback  回滚会结束用户的事务,并撤销正在进行的所有未提交的修改.</li>
<li>chain 定义事务提交后的操作,会立即启动一个新的事务</li>
<li>release 定义事务回滚之后的操作,release 会断开和客户端的连接.</li>
<li>set autocommit =0 禁止自动提交事务 =1 开启自动提交事务</li>
</ul>
<p>在事务中可以通过定义savepoint,指定回滚事务的一个部分,但是不能指定提交事务的一个部分。对于复杂的应用,可以定义多个不同的savepoint,满足不同的条件时,回滚不同的 savepoint。需要注意的是, 如果定义了 相同名字的 savepoint ,则后面定义的savepoint会覆盖之前的定义。对于不再需要使用的savepoint,可以通过release savepoint命令删除savepoint,删除后的savepoint,不能再执行rollback to savepoint命令。</p>
<h3 id="常用SQL技巧"><a href="#常用SQL技巧" class="headerlink" title="常用SQL技巧"></a>常用SQL技巧</h3><h5 id="检索包含最大-最小值的行-使用max-min-函数-找不到返回NULL"><a href="#检索包含最大-最小值的行-使用max-min-函数-找不到返回NULL" class="headerlink" title="检索包含最大/最小值的行(使用max min 函数 找不到返回NULL)"></a>检索包含最大/最小值的行(使用max min 函数 找不到返回NULL)</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Select Student_name ,MIN(test_score),MAX(test_score) from Student group by student_name;</span><br></pre></td></tr></table></figure>
<h5 id="提取随机行"><a href="#提取随机行" class="headerlink" title="提取随机行"></a>提取随机行</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 随机顺序检索数据行</span><br><span class="line">select * from name order by rand();</span><br></pre></td></tr></table></figure>
<p>order by rand() 和limit 结合可以从一组列中选择随机样本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * from table1,table2 where a=b and c&lt;d order by rand() limit 1000;</span><br></pre></td></tr></table></figure>

      
    </div>

    
      
      

  <div class="post-copyright">
    <p class="copyright-item">
      <span>Author: </span>
      <a href="https://corn1ng.github.io">corn1ng</a>
    </p>
    <p class="copyright-item">
      <span>Link: </span>
      <a href="https://corn1ng.github.io/2017/12/04/Mysql-使用指南/">https://corn1ng.github.io/2017/12/04/Mysql-使用指南/</a>
    </p>
    <p class="copyright-item">
      <span>License: </span>
      
      <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/" target="_blank">知识共享署名-非商业性使用 4.0 国际许可协议</a>
    </p>
  </div>



      
      
    

    
      <footer class="post-footer">
        
          <div class="post-tags">
            
              <a href="/tags/Mysql/">Mysql</a>
            
          </div>
        
        
        
  <nav class="post-nav">
    
      <a class="prev" href="/2017/12/05/Python-多线程/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text nav-default">Python 多线程</span>
        <span class="prev-text nav-mobile">Prev</span>
      </a>
    
    
      <a class="next" href="/2017/12/04/leetcode189/">
        <span class="next-text nav-default">189. Rotate Array</span>
        <span class="prev-text nav-mobile">Next</span>
        <i class="iconfont icon-right"></i>
      </a>
    
  </nav>

      </footer>
    

  </article>


          </div>
          
  <div class="comments" id="comments">
    
  </div>


        </div>
      </main>

      <footer id="footer" class="footer">

  <div class="social-links">
    
      
        
          <a href="mailto:wangkangning1@foxmail.com" class="iconfont icon-email" title="email"></a>
        
      
    
      
    
      
    
      
    
      
    
      
    
      
        
          <a href="http://github.com/corn1ng" class="iconfont icon-github" title="github"></a>
        
      
    
      
    
      
    
      
    
      
    
      
    
      
        
          <a href="https://www.instagram.com/brett0427/" class="iconfont icon-instagram" title="instagram"></a>
        
      
    
    
    
      
      <a href="/atom.xml" class="iconfont icon-rss" title="rss"></a>
    
  </div>


<div class="copyright">
  

  <span class="copyright-year">
    
    &copy; 
     
      2017 - 
    
    2018

    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">corn1ng</span>
  </span>
</div>

      </footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>

    
  
  

  



    
  





  
    <script type="text/javascript" src="/lib/jquery/jquery-3.1.1.min.js"></script>
  

  
    <script type="text/javascript" src="/lib/slideout/slideout.js"></script>
  

  
    <script type="text/javascript" src="/lib/fancybox/jquery.fancybox.pack.js"></script>
  


    <script type="text/javascript" src="/js/src/even.js?v=2.6.0"></script>
<script type="text/javascript" src="/js/src/bootstrap.js?v=2.6.0"></script>

    
    <script type="text/javascript"
    color="0,0,255" opacity='0.99' zIndex="-2" count="100" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>
    
  </body>
</html>
