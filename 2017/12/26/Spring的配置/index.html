<!DOCTYPE html>
<html lang="en">
  <head>
    
<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">



  <meta name="description" content="Spring的配置"/>




  <meta name="keywords" content="Spring, Corn1ng's Blog" />










  <link rel="alternate" href="/default" title="Corn1ng's Blog">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=2.6.0" />



<link rel="canonical" href="https://corn1ng.github.io/2017/12/26/Spring的配置/"/>


<link rel="stylesheet" type="text/css" href="/css/style.css?v=2.6.0" />



  <link rel="stylesheet" type="text/css" href="/lib/fancybox/jquery.fancybox.css" />




  



  <script id="baidu_push">
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>









    <title> Spring的配置 - Corn1ng's Blog </title>\
    <style type="text/css">
    .content-wrapper:{top:200px;}
    .footer:{top:200px;}
    </style>
  </head>

  <body><div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/." class="logo">Corn1ng's Blog</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>

<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    
      <a href="/">
        <li class="mobile-menu-item">
          
          
            Home
          
        </li>
      </a>
    
      <a href="/archives/">
        <li class="mobile-menu-item">
          
          
            Archives
          
        </li>
      </a>
    
      <a href="/tags">
        <li class="mobile-menu-item">
          
          
            Tags
          
        </li>
      </a>
    
      <a href="/categories">
        <li class="mobile-menu-item">
          
          
            Categories
          
        </li>
      </a>
    
      <a href="/about">
        <li class="mobile-menu-item">
          
          
            About
          
        </li>
      </a>
    
  </ul>
</nav>

    <div class="container" id="mobile-panel">
      <header id="header" class="header"><div class="logo-wrapper">
  <a href="/." class="logo">Corn1ng's Blog</a>
</div>

<nav class="site-navbar">
  
    <ul id="menu" class="menu">
      
        <li class="menu-item">
          <a class="menu-item-link" href="/">
            
            
              Home
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/archives/">
            
            
              Archives
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/tags">
            
            
              Tags
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/categories">
            
            
              Categories
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/about">
            
            
              About
            
          </a>
        </li>
      
    </ul>
  
</nav>

      </header>
      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content">
            
  
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          Spring的配置
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          2017-12-26
        </span>
        
          <div class="post-category">
            
              <a href="/categories/Java/">Java</a>
            
          </div>
        
        
      </div>
    </header>

    
    
  <div class="post-toc" id="post-toc">
    <h2 class="post-toc-title">Contents</h2>
    <div class="post-toc-content">
      <ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#基于XML的配置"><span class="toc-text">基于XML的配置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#装配一个Bean"><span class="toc-text">装配一个Bean</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#整合多个配置文件"><span class="toc-text">整合多个配置文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#基于注解的配置"><span class="toc-text">基于注解的配置</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#使用注解定义Bean"><span class="toc-text">使用注解定义Bean</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#扫描注解定义的Bean"><span class="toc-text">扫描注解定义的Bean</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#自动装配Bean"><span class="toc-text">自动装配Bean</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#对集合类进行标注"><span class="toc-text">对集合类进行标注</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#延迟依赖注入"><span class="toc-text">延迟依赖注入</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Spring-的配置方法"><span class="toc-text">Spring 的配置方法</span></a>
    </div>
  </div>


    <div class="post-content">
      
        <p>要使spring容器成功启动,需要具备下面三个条件,spring框架的类包都已经放到应用程序的类路径下,应用程序为spring提供了完整的Bean配置信息,Bean的类都已经放到应用程序的类路径下.</p>
<p>spring容器和Bean的使用流程图如下:</p>
<a id="more"></a>
<p><img src="http://one-1252095801.cosgz.myqcloud.com/Screenshot%20from%202017-12-26%2021-37-34.png" alt=""></p>
<h4 id="基于XML的配置"><a href="#基于XML的配置" class="headerlink" title="基于XML的配置"></a>基于XML的配置</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xmlns:tx</span>=<span class="string">"http://www.springframework.org/schema/tx"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xmlns:mvc</span>=<span class="string">"http://www.springframework.org/schema/mvc"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/tx</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/tx/spring-tx.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/mvc</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/mvc/spring-mvc.xsd"</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>XML Schema 描述 XML 文档的结构。首先在上面的配置文件中</p>
<p><code>xmlns=&quot;http://www.springframework.org/schema/beans&quot;</code>规定了默认的命名空间,用于spring bean 的定义</p>
<p><code>xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</code> 是标准命名空间,用于为每个文档中的命名空间指定相应的Schema 样式文件,是W3C 定义的标准命名空间</p>
<p><code>xmlns:tx=&quot;http://www.springframework.org/schema/tx&quot;</code>这种都属于自定义的命名空间,比如tx就表示spring配置事务的命名空间.</p>
<p>命名空间的定义分为两个步骤.</p>
<ul>
<li>第一步指定命名空间的名称,</li>
<li>第二步指定命名空间的schema文档格式文件的位置,用空格或者回车换行就进行分割.</li>
</ul>
<p>在第一步中,需要指定命名空间的缩略名和全名比如</p>
<p><code>xmlns:tx=&quot;http://www.springframework.org/schema/tx&quot;</code> tx为命名空间的别名,一般使用简记的形式,而<code>http://www.springframework.org/schema/tx</code>为空间的全限定名,习惯上用文档发布机构的官方网站和相关网站目录作为全限定名</p>
<p>如果命名空间的别名为空,则表示该命名空间为文档默认命名空间,文档中无命名空间前缀的都属于默认命名空间.如<code>&lt;beans&gt;</code></p>
<p>第二步中,为每个命名空间指定了对应的schema文档格式的定义文件,定义的语法如下:</p>
<p><code>&lt;命名空间1&gt; &lt;1的schema文件&gt;  命名空间2&gt; &lt;2的schema文件&gt;</code></p>
<p>命名空间使用全限定名,每个组织机构在发布schema文件后,都会为该schema文件提供一个引用的URL地址,一般使用这个URL地址指定命名空间对应的schema文件.</p>
<h4 id="装配一个Bean"><a href="#装配一个Bean" class="headerlink" title="装配一个Bean"></a>装配一个Bean</h4><p>在spring容器的配置文件中定义一个简要bean的配置片段</p>
<p><code>&lt;bean id=&quot;Foo&quot; class=&quot;com.smart.Foo&quot;&gt;</code></p>
<p>一般情况,springIoC容器中的一个Bean对应配置文件中的一个<code>&lt;bean&gt;</code>,通过容器的getBean()即可获取相应的bean.</p>
<h4 id="整合多个配置文件"><a href="#整合多个配置文件" class="headerlink" title="整合多个配置文件"></a>整合多个配置文件</h4><p>spring允许使用import将多个配置文件引入到一个文件中,进行配置文件的集成.(p命名空间是一种简化的配置方式,)</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">import</span> <span class="attr">resource</span>=<span class="string">"classpath:com/sysu/beans1.xml"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"b1"</span> <span class="attr">class</span>=<span class="string">"com.Boss"</span> <span class="attr">p:name</span>=<span class="string">"John"</span> <span class="attr">p:car-ref</span>=<span class="string">"car1"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"b2"</span> <span class="attr">class</span>=<span class="string">"com.Boss"</span> <span class="attr">p:name</span>=<span class="string">"John"</span> <span class="attr">p:car-ref</span>=<span class="string">"car2"</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><code>p:name =&quot;john&quot;</code> 就是property name的值为john .p:属性-ref=”其他bean的id” 是引用bean.</p>
<h4 id="基于注解的配置"><a href="#基于注解的配置" class="headerlink" title="基于注解的配置"></a>基于注解的配置</h4><h5 id="使用注解定义Bean"><a href="#使用注解定义Bean" class="headerlink" title="使用注解定义Bean"></a>使用注解定义Bean</h5><p>前面说,spring容器成功启动的三个要件是bean定义信息,bean实现类,及spring本身,如果用XML方式,那么定义信息和实现类就是分离的,基于注解则是一个更好的方法.</p>
<p>例如在Dao上使用@Component注解,就可以被spring容器识别,并转换为容器管理的Bean.</p>
<ul>
<li>@Repository 用于对DAO实现类进行标注</li>
<li>@Service 用于对Service实现类进行标注</li>
<li>@Controller 用于对Controller实现类进行标注</li>
</ul>
<h5 id="扫描注解定义的Bean"><a href="#扫描注解定义的Bean" class="headerlink" title="扫描注解定义的Bean"></a>扫描注解定义的Bean</h5><p>spring 提供了一个context命名空间,提供了通过扫描类包以应用注解定义Bean的方式,</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">beans</span></span></span><br><span class="line"><span class="tag"><span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context/spring-context.xsd&gt;                           </span></span></span><br><span class="line"><span class="tag"><span class="string">&lt;context:component-scan base-package="</span><span class="attr">com.smart.anno</span>"/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>声明context命名空间后,就可以通过context命名空间的Component-scan 的base-package属性指定一个需要扫描的基类包,spring会扫描这个基类包的所有类,并从类的注解信息中获取Bean的定义信息.</p>
<h4 id="自动装配Bean"><a href="#自动装配Bean" class="headerlink" title="自动装配Bean"></a>自动装配Bean</h4><p>spring使用@Autowired注解实现Bean的依赖注入,@Autowired默认<strong>按类型匹配</strong>的方式在容器中查找匹配的Bean,当且仅有一个匹配的Bean的时候,Spring将其注入@Autowired标注的变量中.</p>
<p>如果希望spring即使找不到对应的Bean也不要报出异常,可以用<code>@Autowired(required=false)进行标注</code></p>
<p>如果在容器中有一个以上匹配的Bean时,可以通过@Qualifier注解限定Bean的名称例如</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> class <span class="title">LoginService</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">  	<span class="meta">@Qualifier</span>(<span class="string">"userdao"</span>)</span><br><span class="line">  	<span class="keyword">private</span> UserDap userdao;</span><br><span class="line">  	<span class="comment">//注入名为userdao,类型为UserDao的Bean.</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>也可以在类方法上标注@Autowired,也更加推荐这样写.</p>
<h5 id="对集合类进行标注"><a href="#对集合类进行标注" class="headerlink" title="对集合类进行标注"></a>对集合类进行标注</h5><p>spring如果发现变量是一个Lis和一个Map集合类,它会将容器中匹配集合元素类型的所有Bean都注入进来,</p>
<h5 id="延迟依赖注入"><a href="#延迟依赖注入" class="headerlink" title="延迟依赖注入"></a>延迟依赖注入</h5><p>在spring容器启动的时候,对于在Bean上标注@Lazy及@Autowired注解的属性,不会立即注入属性值,而会延迟到调用此属性的时候才会注入属性值.</p>
<h3 id="Spring-的配置方法"><a href="#Spring-的配置方法" class="headerlink" title="Spring 的配置方法"></a>Spring 的配置方法</h3><p>Spring的配置方法有三种，分别是基于XML的配置，基于注解的配置和基于Java Config 的配置。</p>
<p>基于XML注入有getter/setter注入和构造器注入。</p>

      
    </div>

    
      
      

  <div class="post-copyright">
    <p class="copyright-item">
      <span>Author: </span>
      <a href="https://corn1ng.github.io">corn1ng</a>
    </p>
    <p class="copyright-item">
      <span>Link: </span>
      <a href="https://corn1ng.github.io/2017/12/26/Spring的配置/">https://corn1ng.github.io/2017/12/26/Spring的配置/</a>
    </p>
    <p class="copyright-item">
      <span>License: </span>
      
      <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/" target="_blank">知识共享署名-非商业性使用 4.0 国际许可协议</a>
    </p>
  </div>



      
      
    

    
      <footer class="post-footer">
        
          <div class="post-tags">
            
              <a href="/tags/Spring/">Spring</a>
            
          </div>
        
        
        
  <nav class="post-nav">
    
      <a class="prev" href="/2017/12/27/SpringAOP/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text nav-default">SpringAOP</span>
        <span class="prev-text nav-mobile">Prev</span>
      </a>
    
    
      <a class="next" href="/2017/12/26/建造者模式/">
        <span class="next-text nav-default">建造者模式(生成器模式)</span>
        <span class="prev-text nav-mobile">Next</span>
        <i class="iconfont icon-right"></i>
      </a>
    
  </nav>

      </footer>
    

  </article>


          </div>
          
  <div class="comments" id="comments">
    
  </div>


        </div>
      </main>

      <footer id="footer" class="footer">

  <div class="social-links">
    
      
        
          <a href="mailto:wangkangning1@foxmail.com" class="iconfont icon-email" title="email"></a>
        
      
    
      
    
      
    
      
    
      
    
      
    
      
        
          <a href="http://github.com/corn1ng" class="iconfont icon-github" title="github"></a>
        
      
    
      
    
      
    
      
    
      
    
      
    
      
        
          <a href="https://www.instagram.com/brett0427/" class="iconfont icon-instagram" title="instagram"></a>
        
      
    
    
    
      
      <a href="/atom.xml" class="iconfont icon-rss" title="rss"></a>
    
  </div>


<div class="copyright">
  

  <span class="copyright-year">
    
    &copy; 
     
      2017 - 
    
    2019

    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">corn1ng</span>
  </span>
</div>

      </footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>

    
  
  

  



    
  





  
    <script type="text/javascript" src="/lib/jquery/jquery-3.1.1.min.js"></script>
  

  
    <script type="text/javascript" src="/lib/slideout/slideout.js"></script>
  

  
    <script type="text/javascript" src="/lib/fancybox/jquery.fancybox.pack.js"></script>
  


    <script type="text/javascript" src="/js/src/even.js?v=2.6.0"></script>
<script type="text/javascript" src="/js/src/bootstrap.js?v=2.6.0"></script>

    
    <script type="text/javascript"
    color="0,0,255" opacity='0.99' zIndex="-2" count="100" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>
    
  </body>
</html>
